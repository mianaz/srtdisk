<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write data to an HDF5 group — WriteH5Group • srtdisk</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write data to an HDF5 group — WriteH5Group"><meta name="description" content='Writing data to HDF5 files can be done simply with usually sensible defaults.
However, when wanting any semblance of control over how an R object is
written out, the code constructs get complicated quickly. WriteH5Group
provides a wrapper with sensible defaults over some of these complex code
constructs to provide greater control over how data are written to disk.
These defaults were chosen to fit best with h5Seurat files, see
vignette("h5Seurat-spec") for more
details'><meta property="og:description" content='Writing data to HDF5 files can be done simply with usually sensible defaults.
However, when wanting any semblance of control over how an R object is
written out, the code constructs get complicated quickly. WriteH5Group
provides a wrapper with sensible defaults over some of these complex code
constructs to provide greater control over how data are written to disk.
These defaults were chosen to fit best with h5Seurat files, see
vignette("h5Seurat-spec") for more
details'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">srtdisk</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/convert-anndata.html">Conversions: h5Seurat and AnnData</a></li>
    <li><a class="dropdown-item" href="../articles/h5Seurat-load.html">Saving and Loading Data from an h5Seurat File</a></li>
    <li><a class="dropdown-item" href="../articles/h5Seurat-spec.html">h5Seurat File Format Specification</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mianaz/srtdisk/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Write data to an HDF5 group</h1>
      <small class="dont-index">Source: <a href="https://github.com/mianaz/srtdisk/blob/HEAD/R/WriteH5Group.R" class="external-link"><code>R/WriteH5Group.R</code></a></small>
      <div class="d-none name"><code>WriteH5Group.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Writing data to HDF5 files can be done simply with usually sensible defaults.
However, when wanting any semblance of control over how an R object is
written out, the code constructs get complicated quickly. <code>WriteH5Group</code>
provides a wrapper with sensible defaults over some of these complex code
constructs to provide greater control over how data are written to disk.
These defaults were chosen to fit best with <a href="h5Seurat-class.html">h5Seurat</a> files, see
<code><a href="../doc/h5Seurat-spec.html">vignette("h5Seurat-spec")</a></code> for more
details</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'ANY'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'array'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Assay'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'data.frame'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'dgCMatrix'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'DimReduc'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'factor'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Graph'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'list'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'logical'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Neighbor'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SeuratCommand'</span></span>
<span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="va">x</span>, <span class="va">name</span>, <span class="va">hgroup</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Name to save data as</p></dd>


<dt id="arg-hgroup">hgroup<a class="anchor" aria-label="anchor" href="#arg-hgroup"></a></dt>
<dd><p>An HDF5 file or group (<code>H5File</code> or <code>H5Group</code> objects
from hdf5r)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Show progress updates</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns <code>NULL</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Setup an HDF5 file</span></span></span>
<span class="r-in"><span><span class="va">hfile</span> <span class="op">&lt;-</span> <span class="fu">hdf5r</span><span class="fu">::</span><span class="va"><a href="http://hhoeflin.github.io/hdf5r/reference/H5File-class.html" class="external-link">H5File</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">'.h5'</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">'a'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Data frames are stored as either datasets or groups, depending on the</span></span></span>
<span class="r-in"><span><span class="co"># presence of factor columns</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'g1'</span>, <span class="st">'g1'</span>, <span class="st">'g2'</span>, <span class="st">'g1'</span>, <span class="st">'g2'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span></span>
<span class="r-in"><span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When no factor columns are present, the data frame is written as a single</span></span></span>
<span class="r-in"><span><span class="co"># HDF5 compound dataset</span></span></span>
<span class="r-in"><span><span class="fu">WriteH5Group</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>, name <span class="op">=</span> <span class="st">'df'</span>, hgroup <span class="op">=</span> <span class="va">hfile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hfile</span><span class="op">[[</span><span class="st">'df'</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class: H5Group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filename: /private/var/folders/9l/bl67cpdj3rzgkx2pfk0flmhc0000gn/T/Rtmp4a1mjo/file17ce74b59be3b.h5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group: /df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Attributes: colnames, _index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Listing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    name    obj_type dataset.dims dataset.type_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  _index H5I_DATASET            5         H5T_STRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x H5I_DATASET            5         H5T_STRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       y H5I_DATASET            5        H5T_INTEGER</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When factors are present, the data frame is written as a group</span></span></span>
<span class="r-in"><span><span class="co"># This is because h5py does not implement HDF5 Enums, so factor level</span></span></span>
<span class="r-in"><span><span class="co"># information would be lost</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">WriteH5Group</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>, name <span class="op">=</span> <span class="st">'df.factor'</span>, hgroup <span class="op">=</span> <span class="va">hfile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hfile</span><span class="op">[[</span><span class="st">'df.factor'</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class: H5Group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filename: /private/var/folders/9l/bl67cpdj3rzgkx2pfk0flmhc0000gn/T/Rtmp4a1mjo/file17ce74b59be3b.h5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group: /df.factor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Attributes: colnames, _index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Listing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    name    obj_type dataset.dims dataset.type_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  _index H5I_DATASET            5         H5T_STRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x   H5I_GROUP         &lt;NA&gt;               &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       y H5I_DATASET            5        H5T_INTEGER</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Factors turn into a group with two components: values and levels</span></span></span>
<span class="r-in"><span><span class="co"># This is to preserve level information for HDF5 APIs that don't implement</span></span></span>
<span class="r-in"><span><span class="co"># the HDF5 Enum type (eg. h5py)</span></span></span>
<span class="r-in"><span><span class="co"># values corresponds to the integer values of each member of a factor</span></span></span>
<span class="r-in"><span><span class="co"># levels is a string dataset with one entry per level</span></span></span>
<span class="r-in"><span><span class="va">fctr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'g1'</span>, <span class="st">'g1'</span>, <span class="st">'g2'</span>, <span class="st">'g1'</span>, <span class="st">'g2'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">WriteH5Group</span><span class="op">(</span>x <span class="op">=</span> <span class="va">fctr</span>, name <span class="op">=</span> <span class="st">'factor'</span>, hgroup <span class="op">=</span> <span class="va">hfile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hfile</span><span class="op">[[</span><span class="st">'factor'</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class: H5Group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filename: /private/var/folders/9l/bl67cpdj3rzgkx2pfk0flmhc0000gn/T/Rtmp4a1mjo/file17ce74b59be3b.h5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group: /factor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Listing:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    name    obj_type dataset.dims dataset.type_class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  levels H5I_DATASET            2         H5T_STRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  values H5I_DATASET            5        H5T_INTEGER</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Logicals get encoded as integers with the following mapping</span></span></span>
<span class="r-in"><span><span class="co"># FALSE becomes 0L</span></span></span>
<span class="r-in"><span><span class="co"># TRUE becomes 1L</span></span></span>
<span class="r-in"><span><span class="co"># NA becomes 2L</span></span></span>
<span class="r-in"><span><span class="co"># These are stored as H5T_INTEGERS instead of H5T_LOGICALS</span></span></span>
<span class="r-in"><span><span class="co"># Additionally, an attribute called "s3class" is written with the value of "logical"</span></span></span>
<span class="r-in"><span><span class="fu">WriteH5Group</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"logicals"</span>, hgroup <span class="op">=</span> <span class="va">hfile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hfile</span><span class="op">[[</span><span class="st">"logicals"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class: H5D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dataset: /logicals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filename: /private/var/folders/9l/bl67cpdj3rzgkx2pfk0flmhc0000gn/T/Rtmp4a1mjo/file17ce74b59be3b.h5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Access type: H5F_ACC_RDWR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Attributes: s3class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Datatype: H5T_STD_I32LE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Space: Type=Simple     Dims=3     Maxdims=Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chunk: 2048</span>
<span class="r-in"><span><span class="va">hfile</span><span class="op">[[</span><span class="st">"logicals"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">attr_open</span><span class="op">(</span><span class="st">"s3class"</span><span class="op">)</span><span class="op">$</span><span class="fu">read</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "logical"</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Close and remove the HDF5 file</span></span></span>
<span class="r-in"><span><span class="va">hfile</span><span class="op">$</span><span class="fu">close_all</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="va">hfile</span><span class="op">$</span><span class="va">filename</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miana Z, Paul Hoffman, Rahul Satija.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

